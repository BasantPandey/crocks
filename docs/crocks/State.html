<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta content="minimum-scale=1.0, width=device-width" name="viewport"><meta name="description" content="State Crock"><title>State - Crocks</title><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|Roboto+Mono"><!-- inject:css --><link rel="stylesheet" href="/crocks/vendor/galano/galano.css"><link rel="stylesheet" href="/crocks/vendor/icon-12/icon-12.css"><link rel="stylesheet" href="/crocks/vendor/icon-16/icon-16.css"><link rel="stylesheet" href="/crocks/vendor/senna/senna.css"><link rel="stylesheet" href="/crocks/vendor/codemirror/lib/codemirror.css"><link rel="stylesheet" href="/crocks/vendor/codemirror/theme/blackboard.css"><!-- endinject --><!-- inject:js --><script src="/crocks/js/bundles/shared.electric.js"></script><script src="/crocks/vendor/senna/senna.js"></script><script src="/crocks/vendor/codemirror/lib/codemirror.js"></script><script src="/crocks/vendor/codemirror/mode/haskell/haskell.js"></script><script src="/crocks/vendor/codemirror/mode/javascript/javascript.js"></script><!-- endinject --><link rel="icon" href="/crocks/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/crocks/styles/main.css"></head><body data-senna><div data-senna-surface id="wrapper"><div class="senna-loading-bar"></div><!-- inject:metal:js --><div id="pageComponent"><div class="main"><main class="guide"><div class="docs"><nav class="topbar topbar-light topbar-docs"><div class="topbar-logo"><a class="topbar-logo-link" href="/crocks"><span class="topbar-logo-icon icon-16-loop"></span><h3 class="topbar-logo-text">Crocks</h3></a></div><nav class="topbar-menu"><button class="topbar-toggle">Menu</button><ul class="topbar-list"><li class="topbar-item"><a class="topbar-link topbar-link-selected" href="/crocks/docs/" target="undefined"><span>Documentation</span></a></li></ul></nav></nav><nav class="sidebar"><a class="sidebar-header toggler-header-collapsed"><span class="sidebar-icon icon-16-menu"></span><span>Docs Menu</span><span class="sidebar-icon-right"><span class="icon-12-arrow-down-short"></span><span class="icon-12-arrow-up-short"></span></span></a><div class="sidebar-toggler-content toggler-collapsed"><div class="sidebar-search"><div class="page-autocomplete"><div class="form-group"><div class="input-inner-addon input-inner-addon-right"><input autocomplete="off" class="form-control" name="q" placeholder="Search Docs" ref="input" required type="text" ><span class="input-inner-icon-helper icon-16-magnifier"></span></div></div></div></div><nav class=""><ul class="sidebar-list sidebar-list-1"><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/getting-started.html"><span class="sidebar-icon icon-16-arrow-right-rod"></span><span>Getting Started</span></a></li><li class="sidebar-item active"><a class="sidebar-link sidebar-link-selected" href="/crocks/docs/crocks/"><span class="sidebar-icon icon-16-code-file"></span><span>Crocks</span></a><nav class=""><ul class="sidebar-list sidebar-list-1"><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/crocks/Arrow.html"><span>Arrow</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/crocks/Equiv.html"><span>Equiv</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/crocks/Pred.html"><span>Pred</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/crocks/Reader.html"><span>Reader</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/crocks/ReaderT.html"><span>ReaderT</span></a></li><li class="sidebar-item active"><a class="sidebar-link sidebar-link-selected" href="/crocks/docs/crocks/State.html"><span>State</span></a></li></ul></nav></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/monoids/"><span class="sidebar-icon icon-16-code-file"></span><span>Monoids</span></a><nav class=""><ul class="sidebar-list sidebar-list-1"><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/monoids/All.html"><span>All</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/monoids/Any.html"><span>Any</span></a></li></ul></nav></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/functions/"><span class="sidebar-icon icon-16-code-file"></span><span>Functions</span></a><nav class=""><ul class="sidebar-list sidebar-list-1"><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/functions/combinators.html"><span>Combinators</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/functions/helpers.html"><span>Helpers</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/functions/logic-functions.html"><span>Logic Functions</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/functions/predicate-functions.html"><span>Predicate Functions</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/functions/pointfree-functions.html"><span>Point-free Functions</span></a></li><li class="sidebar-item"><a class="sidebar-link " href="/crocks/docs/functions/transformation-functions.html"><span>Transformation Functions</span></a></li></ul></nav></li></ul></nav></div></nav><div class="sidebar-offset"><header class="guide-header"><div class="container-hybrid"><h1 class="title">State</h1></div></header><div class="container-hybrid"><div class="docs-guide row"><div class="docs-content col-xs-16 col-md-9"><div class="guide-content"><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State s a</code></pre></div><p><code>State</code> is an Algebraic Data Type that abstracts away the associated state management that comes with stateful computations.<code>State</code> is parameterized by two types, a state <code>s</code> and a resultant <code>a</code>. The resultant portion may vary it's type, but the state portion must be fixed to a type that is used by all related stateful computations.</p><p>All <code>State</code> instances wrap a function of the form <code>s -&gt; Pair a s</code> and can be constructed by providing a function of this form. In order to get maximum reuse of existing functions, a few construction helpers are available on the<code>State</code> constructor.</p><p><code>State</code> is lazy and is required to be run at the edge with some initial state. Three methods are available on the instance for running the <code>State</code> with a given initial state. <a href="#runwith"><code>runWith</code></a> will return a <code>Pair a s</code> with the state <code>s</code> on the right and the resultant <code>a</code> on the left.</p><p>The other two are used for extracting either the state or resultant, unwrapping the values from the <code>Pair</code> and discarding the unwanted portion.<a href="#evalwith"><code>evalWith</code></a> used when the resultant is wanted, while<a href="#execwith"><code>execWith</code></a> is used to pull the state.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const State = require(&#39;crocks/State&#39;)
const { get, put } = State

const Pair = require(&#39;crocks/Pair&#39;)
const constant = require(&#39;crocks/combinators/constant&#39;)


// toUpper :: String -&gt; String
const toUpper =
  x =&gt; x.toUpperCase()

// putResultant :: String -&gt; State String String
const putResultant = x =&gt;
  put(x)
    .map(constant(x))

// standard construction
// State String String
State(s =&gt; Pair(toUpper(s), s))
  .runWith(&#39;nice&#39;)
//=&gt; Pair(&#39;NICE&#39;, &#39;nice&#39;)

// construction helper
// State String String
get(toUpper)
  .runWith(&#39;nice&#39;)
//=&gt; Pair(&#39;NICE&#39;, &#39;nice&#39;)

// combine states
get(toUpper)
  .chain(putResultant)
  .runWith(&#39;nice&#39;)
//=&gt; Pair(&#39;NICE&#39;, &#39;NICE&#39;)

// pull resultant only
get(toUpper)
  .evalWith(&#39;nice&#39;)
//=&gt; &#39;NICE&#39;

// pull state only
get(toUpper)
  .execWith(&#39;nice&#39;)
//=&gt; &#39;nice&#39;</code></pre></div><article id="topic-implements"><h2><a id="implements"href="#implements">Implements</a></h2><p><code>Functor</code>, <code>Apply</code>, <code>Chain</code>, <code>Applicative</code>, <code>Monad</code></p></article><article id="topic-constructor"><h2><a id="constructor-methods"href="#constructor-methods">Constructor Methods</a></h2><h4><a id="get"href="#get">get</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State.get :: () -&gt; State s s
State.get :: (s -&gt; a) -&gt; State s a</code></pre></div><p>A construction helper that is used to access the state portion of a given<code>State</code> instance. To make the state accessible, <code>get</code> will place the state in the resultant portion, overwriting what was there previously.</p><p><code>get</code> may be called with or without a function as it's argument. When nothing is provided for the argument, the state will be applied to the resultant as is. The state will be mapped over any provided function that takes the same type as the state, with the result deposited in the resultant.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { get } = require(&#39;crocks/State&#39;)

const chain = require(&#39;crocks/pointfree/chain&#39;)
const compose = require(&#39;crocks/helpers/compose&#39;)
const isNumber = require(&#39;crocks/predicates/isNumber&#39;)
const option = require(&#39;crocks/pointfree/option&#39;)
const prop = require(&#39;crocks/Maybe/prop&#39;)
const safe = require(&#39;crocks/Maybe/safe&#39;)

// propOr :: (String, (b -&gt; Boolean), a) -&gt; Object -&gt; c
const propOr = (key, pred, def) =&gt;
  compose(option(def), chain(safe(pred)), prop(key))

// safeNumber :: Object -&gt; Number
const safeNumber =
  propOr(&#39;number&#39;, isNumber, 0)

get(safeNumber)
  .runWith({ number: 23 })
//=&gt; Pair(23, { number: 23 })

get(safeNumber)
  .evalWith({ number: &#39;23&#39; })
//=&gt; 0

get()
  .map(safeNumber)
  .evalWith({ number: 23 })
//=&gt; 23

get()
  .map(safeNumber)
  .runWith({ string: &#39;47&#39; })
//=&gt; Pair(0, { string: &#39;47&#39;})</code></pre></div><h4><a id="modify"href="#modify">modify</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State.modify :: (s -&gt; s) -&gt; State s ()</code></pre></div><p>A construction helper that can be used to lift an endo-function that matches the fixed type of the state portion. The lifted function will receive the state and returns a new <code>State</code> instance with the result of the function in the state portion. Great care should be taken to not use functions that will change the type of the state as it may not be expected in other stateful computations and can result in hard to track down bugs.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { modify } = require(&#39;crocks/State&#39;)

const mapProps = require(&#39;crocks/helpers/mapProps&#39;)

// add :: Number -&gt; Number -&gt; Number
const add =
  x =&gt; y =&gt; x + y

// addState :: Number -&gt; State Number ()
const addState = x =&gt;
  modify(add(x))

// addValue :: Number -&gt; State Object ()
const addValue = x =&gt;
  modify(mapProps({ value: add(x) }))

addState(5)
  .execWith(45)
//=&gt; 50

addValue(5)
  .execWith({ value: 45 })
//=&gt; { value: 50 }

addValue(5)
  .execWith({})
//=&gt; {}</code></pre></div><h4><a id="put"href="#put">put</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State.put :: s -&gt; State s ()</code></pre></div><p>Used to replace the state portion of a given State instance,, <code>put</code> can be employed anytime that the state can change without having to know about it's previous value. If the previous value is required for a given stateful computation, <a href="#modify"><code>modify</code></a> can be used to lift a function that represents the change.</p><p>As put updates the state, it is important to ensure that the state portion stays fixed for all related functions. Changing the type of the state portion may result in hard to debug bugs and destroys the relationship between stateful computations.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { put } = require(&#39;crocks/State&#39;)

const compose = require(&#39;crocks/helpers/compose&#39;)
const isString = require(&#39;crocks/predicates/isString&#39;)
const option = require(&#39;crocks/pointfree/option&#39;)
const safe = require(&#39;crocks/Maybe/safe&#39;)

// safeString :: a -&gt; String
const safeString =
  compose(option(&#39;&#39;), safe(isString))

// reset :: () -&gt; State String ()
const reset = () =&gt;
  put(&#39;&#39;)

// update :: a -&gt;  State String ()
const update =
  compose(put, safeString)

// heckYeah :: State String ()
const heckYeah =
  update(&#39;Oh Heck Yeah&#39;)

heckYeah
  .execWith(&#39;Gosh&#39;)
//=&gt; &#39;Oh Heck Yeah&#39;

heckYeah
  .chain(reset)
  .runWith(&#39;Gosh&#39;)
// Pair((), &#39;&#39;)</code></pre></div><h4><a id="of"href="#of">of</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State.of :: a -&gt; State s a</code></pre></div><p>Used to &quot;blindly&quot; lift any Javascript value into a <code>State</code>, <code>of</code> will take the provided value and return back a new <code>State</code> instance with the value in the resultant. There are many uses for <code>of</code>, but mostly it is used to set the resultant in the same way <a href="#put"><code>put</code></a> is used to replace the state. Many times<code>of</code> is used at the start of a given stateful computation or in conjunction with <a href="#put"><code>put</code></a> and <a href="#modify"><code>modify</code></a> to replace the <code>Unit</code> the resultant is set to for those construction helpers.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const State = require(&#39;crocks/State&#39;)
const { get, put } = State

// updatePop :: String -&gt; State String String
const updatePop = x =&gt;
  get().chain(
    old =&gt; put(x).chain(
      () =&gt; State.of(old)
    )
  )

State.of(&#39;hotness&#39;)
  .chain(updatePop)
  .runWith(&#39;crusty&#39;)
//=&gt; Pair(&#39;crusty&#39;, &#39;hotness&#39;)</code></pre></div><h4><a id="type"href="#type">type</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State.type :: () -&gt; String</code></pre></div><p><code>type</code> provides a string representation of the type name for a given type in<code>crocks</code>. While it is used mostly internally for law validation, it can be useful to the end user for debugging and building out custom types based on the standard <code>crocks</code> types. While type comparisons can easily be done manually by calling <code>type</code> on a given type, using the <code>isSameType</code> function hides much of the boilerplate. <code>type</code> is available on both the Constructor and the Instance for convenience.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const State = require(&#39;crocks/State&#39;)

const Reader = require(&#39;crocks/Reader&#39;)
const identity = require(&#39;crocks/combinators/identity&#39;)
const isSameType = require(&#39;crocks/predicates/isSameType&#39;)

State.type() //=&gt;  &quot;State&quot;

isSameType(State, State.of(3))        //=&gt; true
isSameType(State, State)              //=&gt; true
isSameType(State, Reader(identity))   //=&gt; false
isSameType(State.of(false), Reader)   //=&gt; false</code></pre></div></article><article id="topic-instance"><h2><a id="instance-methods"href="#instance-methods">Instance Methods</a></h2><h4><a id="map"href="#map">map</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State s a ~&gt; (a -&gt; b) -&gt; State s b</code></pre></div><p>While the state portion <code>s</code> of <code>State</code> must remain fixed to a type, the resultant <code>a</code> can vary in it's type as needed. This allows complex stateful computations to be represented with <code>State</code>. The <code>map</code> method provides a means to lift a function into the datatype that will be applied to the resultant and return a new instance of <code>State</code> with the result of the function as the new resultant.</p><p>While this is similar to the <a href="#modify"><code>modify</code></a> construction helper, which lifts an endo-function that acts upon the state, <code>map</code> does not require an endo-function as it can move to any type.</p><p>Due to the composition law associated with <code>map</code>, successive <code>map</code>s can be composed together using function composition. This will give the same results but will only map the value once, instead of once for every mapping.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { get } = require(&#39;crocks/State&#39;)

const compose = require(&#39;crocks/helpers/compose&#39;)
const objOf = require(&#39;crocks/helpers/objOf&#39;)
const propOr = require(&#39;crocks/helpers/propOr&#39;)

// add :: Number -&gt; Number -&gt; Number
const add =
  x =&gt; y =&gt; x + y

// getNum :: State Object Number
const getNum =
  get(propOr(0, &#39;num&#39;))

getNum
  .map(add(10))
  .evalWith({ num: 32 })
//=&gt; 42

getNum
  .map(add(10))
  .map(objOf(&#39;result&#39;))
  .evalWith({ val: 32 })
//=&gt; { result: 10 }

// comp :: Number -&gt; Object
const comp = compose(
  objOf(&#39;result&#39;),
  add(10)
)

getNum
  .map(comp)
  .evalWith({ num: 32 })
//=&gt; { result: 42 }</code></pre></div><h4><a id="ap"href="#ap">ap</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State s (a -&gt; b) ~&gt; State s a -&gt; State s b</code></pre></div><p>Short for apply, the <code>ap</code> method is used to apply the resultant of a given<code>State</code> instance to a function wrapped in another instance. On a <code>State</code>instance that wraps a function, calling <code>ap</code>, providing it another <code>State</code>instance, will return a new <code>State</code> instance with the result of the function in the resultant portion.</p><p>When used with curried, polyadic functions, multiple stateful computations can be combined using the lifted function as a means to combine each of the instances' resultants.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { get, modify } = require(&#39;crocks/State&#39;)

const assoc = require(&#39;crocks/helpers/assoc&#39;)
const propOr = require(&#39;crocks/helpers/propOr&#39;)

const data = {
  tax: .084,
  sub: 34.97
}

// add :: Number -&gt; Number -&gt; Number
const add =
  x =&gt; y =&gt; x + y

// multiply :: Number -&gt; Number -&gt; Number
const multiply =
  x =&gt; y =&gt; x * y

// round :: Number -&gt; Number
const round =
  x =&gt; Math.round(x * 100) / 100

// getKey :: String -&gt; State Object Number
const getKey = key =&gt;
  get(propOr(0, key))

// updateKey :: String -&gt; a -&gt; State Object ()
const updateKey = key =&gt; val =&gt;
  modify(assoc(key, val))

// addToSub :: Number -&gt; String Object Number
const addToSub = x =&gt;
  getKey(&#39;sub&#39;)
    .map(add(x))

const calcTax =
  getKey(&#39;tax&#39;)
    .map(multiply)
    .ap(getKey(&#39;sub&#39;))

// applyTax :: State Object ()
const applyTax =
  calcTax
    .chain(addToSub)
    .map(round)
    .chain(updateKey(&#39;total&#39;))

applyTax
  .execWith(data)
//=&gt; { tax: 0.084, sub: 34.07, total: 37.91 }</code></pre></div><h4><a id="chain"href="#chain">chain</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State s a ~&gt; (a -&gt; State s b) -&gt; State s b</code></pre></div><p>As a means to combine stateful computations, <code>chain</code> is used to sequence state transactions that either read from or write to the state. <code>chain</code> takes a unary function that must return a new <code>State</code> instance. <code>chain</code> returns a new<code>State</code> instance that will apply the computation when run.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { get, modify } = require(&#39;crocks/State&#39;)

// add :: Number -&gt; State Number ()
const add = x =&gt;
  modify(y =&gt; x + y)

// multiply :: Number -&gt; State Number ()
const multiply = x =&gt;
  modify(y =&gt; x * y)

// double :: () -&gt; State Number ()
const double = () =&gt;
  get()
    .chain(add)

// square :: () -&gt; State Number ()
const square = () =&gt;
  get()
    .chain(multiply)

add(10)
  .execWith(10)
//=&gt; 20

add(10)
  .chain(double)
  .execWith(10)
//=&gt; 40

add(10)
  .chain(square)
  .execWith(10)
//=&gt; 400

add(10)
  .chain(double)
  .chain(square)
  .execWith(10)
//=&gt; 1600</code></pre></div><h4><a id="runwith"href="#runwith">runWith</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State s a ~&gt; s -&gt; Pair a s</code></pre></div><p><code>State</code> is a lazy datatype that requires a value for it's state portion to be run. A given <code>State</code> instance provides a <code>runWith</code> method that accepts a value to run the instance with. The value must be a member of the type that the given <code>State</code> instance is fixed to in it's state portion, <code>s</code>.</p><p>When called, <code>runWith</code> will run the state transition with the given value as the initial state and will return the resulting <code>Pair</code> with the resultant in the<code>fst</code> (first) and the state in the <code>snd</code> (second).</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const State = require(&#39;crocks/State&#39;)
const { get, put } = State

const K = require(&#39;crocks/combinators/constant&#39;)

// swap :: s -&gt; s -&gt; State s s
const swap = x =&gt; old =&gt;
  put(x)
    .chain(K(State.of(old)))

//update :: s -&gt; State s s
const update = x =&gt;
  get()
    .chain(swap(x))

update(45)
  .runWith(100)
//=&gt; Pair(100, 45)</code></pre></div><h4><a id="evalwith"href="#evalwith">evalWith</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State s a ~&gt; s -&gt; a</code></pre></div><p><code>State</code> is a lazy datatype that requires a value for it's state portion to be run. A given <code>State</code> instance provides an <code>evalWith</code> method that accepts a value to run the instance with. The value must be a member of the type that the given <code>State</code> instance is fixed to in it's state portion, <code>s</code>.</p><p>When called, <code>evalWith</code> will run the state transition with the given value as the initial state and will return the resulting resultant discarding the state portion.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const State = require(&#39;crocks/State&#39;)
const { get } = State

const concat = require(&#39;crocks/pointfree/concat&#39;)
const flip = require(&#39;crocks/combinators/flip&#39;)
const liftA2 = require(&#39;crocks/helpers/liftA2&#39;)
const map = require(&#39;crocks/pointfree/map&#39;)
const propOr = require(&#39;crocks/helpers/propOr&#39;)

const name = {
  first: &#39;Franklin&#39;,
  last: &#39;Jennings&#39;
}

// getLast :: State Object String
const getFirst =
  get(propOr(&#39;&#39;, &#39;first&#39;))

// getLast :: State Object String
const getLast =
  get(propOr(&#39;&#39;, &#39;last&#39;))

// inner :: Functor f =&gt; f a -&gt; f [ a ]
const inner =
  map(Array.of)

// combineNames :: State Object [ String ]
const combineNames = liftA2(
  flip(concat),
  inner(getFirst),
  inner(getLast)
)

combineNames
  .evalWith(name)
//=&gt; [ &#39;Franklin&#39;, &#39;Jennings&#39; ]</code></pre></div><h4><a id="execwith"href="#execwith">execWith</a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">State s a ~&gt; s -&gt; s</code></pre></div><p><code>State</code> is a lazy datatype that requires a value for it's state portion to be run. A given <code>State</code> instance provides an <code>execWith</code> method that accepts a value to run the instance with. The value must be a member of the type that the given <code>State</code> instance is fixed to in it's state portion, <code>s</code>.</p><p>When called, <code>execWith</code> will run the state transition with the given value as the initial state and will return the resulting state, discarding the resultant portion.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { modify } = require(&#39;crocks/State&#39;)

const compose = require(&#39;crocks/helpers/compose&#39;)
const concat = require(&#39;crocks/pointfree/concat&#39;)

// toUpper :: String -&gt; String
const toUpper =
  x =&gt; x.toUpperCase()

// exclaim :: String -&gt; String
const exclaim =
  concat(&#39;!!!&#39;)

// yell :: State String ()
const yell = modify(
  compose(exclaim, toUpper)
)

yell
  .execWith(&#39;nice&#39;)
//=&gt; &#39;NICE!!!&#39;</code></pre></div></article><article id="topic-pointfree"><h2><a id="pointfree-functions"href="#pointfree-functions">Pointfree Functions</a></h2><h4><a id="evalwith-pointfree"href="#evalwith-pointfree">evalWith <em>(pointfree)</em></a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">evalWith :: s -&gt; State s a -&gt; a</code></pre></div><p>The <code>evalWith</code> pointfree function can be employed to execute the<a href="#evalwith"><code>evalWith</code></a> method on a given <code>State</code> instance. This function is typically used at the edge of a program where all the side-effects typically reside.</p><p>As all this function does is return the result of applying a given initial state to the <a href="#evalwith"><code>evalWith</code></a> method to the provided <code>State</code> instance, it will also return the resulting resultant, throwing away the resulting state.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const { get } = require(&#39;crocks/State&#39;)

const evalWith = require(&#39;crocks/State/evalWith&#39;)

const compose = require(&#39;crocks/helpers/compose&#39;)
const curry = require(&#39;crocks/helpers/curry&#39;)
const flip = require(&#39;crocks/combinators/flip&#39;)

// addToState :: Number -&gt; State Number Number
const addToState =
  x =&gt; get(y =&gt; x + y)

// add :: Number -&gt; Number -&gt; Number
const add = curry(
  compose(flip(evalWith), addToState)
)

// add10 :: Number -&gt; Number
const add10 =
  add(10)

add10(32)
//=&gt; 42

add(1295, 42)
// 1337</code></pre></div><h4><a id="execwith-pointfree"href="#execwith-pointfree">execWith <em>(pointfree)</em></a></h4><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="haskell" ref="code">execWith :: s -&gt; State s a -&gt; s</code></pre></div><p>The <code>execWith</code> pointfree function can be employed to execute the<a href="#execwith"><code>execWith</code></a> method on a given <code>State</code> instance. This function is typically used at the edge of a program where all the side-effects typically reside.</p><p>As all this function does is return the result of applying a given initial state to the <a href="#execwith"><code>execWith</code></a> method to the provided <code>State</code> instance, it will also return the resulting state, throwing away the resulting resultant.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="javascript" ref="code">const State = require(&#39;crocks/State&#39;)
const { modify } = State

const execWith = require(&#39;crocks/State/execWith&#39;)

const curry = require(&#39;crocks/helpers/curry&#39;)
const isSameType = require(&#39;crocks/predicates/isSameType&#39;)
const mapProps = require(&#39;crocks/helpers/mapProps&#39;)
const when = require(&#39;crocks/logic/when&#39;)

// middleware :: Object -&gt; State Object | Object -&gt; Object
const middleware = curry(
  s =&gt; when(isSameType(State), execWith(s))
)

// incValue :: State Object ()
const incValue =
  modify(mapProps({ value: x =&gt; x + 1 }))

middleware({ value: 10 }, incValue)
//=&gt; { value: 11 }

middleware({ value: 10 }, { value: 32 })
//=&gt; { value: 32 }</code></pre></div></article><input type="hidden" value="State"><input type="hidden" value="Crocks"></div><div class="contribute"><div class="contribute-img"><span class="icon-16-github"></span></div><div class="contribute-text"><p>Contribute on Github! <a href="https://github.com/evilsoft/crocks/tree/master/docs/src/pages/docs/crocks/State.md" class="contribute-link" target="_blank">Edit this section</a>.</p></div></div></div><nav class="col-xs-16 col-md-offset-2 col-md-5"><div class="docs-nav-container"><div class="affix-top docs-nav"><div ref="readingContainer"></div></div></div></nav></div></div></div></div></main></div></div><script src="/crocks/js/bundles/FEvbt.js"></script><script>var data = JSON.parse('{\x22pageLocation\x22:\x22index.children.docs.children.crocks.children.State\x22,\x22site\x22:{\x22title\x22:\x22Crocks\x22,\x22githubRepo\x22:\x22evilsoft\/crocks\x22,\x22googleAnalytics\x22:\x22UA-37033501-5\x22,\x22icon\x22:\x22icon-16-loop\x22,\x22index\x22:{\x22title\x22:\x22Home\x22,\x22description\x22:\x22A collection of well known Monadic Containers for your utter enjoyment.\x22,\x22srcFilePath\x22:\x22src\/pages\/index.soy\x22,\x22id\x22:\x22pages\x22,\x22location\x22:\x22\/.\/\x22,\x22url\x22:\x22\/crocks\/.\/\x22,\x22children\x22:{\x22docs\x22:{\x22children\x22:{\x22getting-started\x22:{\x22title\x22:\x22Getting Started\x22,\x22description\x22:\x22Getting started with a Crocks.\x22,\x22icon\x22:\x22arrow-right-rod\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:1,\x22srcFilePath\x22:\x22src\/pages\/docs\/getting-started.md\x22,\x22id\x22:\x22getting-started\x22,\x22location\x22:\x22\/docs\/getting-started.html\x22,\x22url\x22:\x22\/crocks\/docs\/getting-started.html\x22},\x22search\x22:{\x22title\x22:\x22Search\x22,\x22description\x22:\x22Find what you\x27re looking for in the documentation.\x22,\x22hidden\x22:true,\x22srcFilePath\x22:\x22src\/pages\/docs\/search.soy\x22,\x22id\x22:\x22search\x22,\x22location\x22:\x22\/docs\/search.html\x22,\x22url\x22:\x22\/crocks\/docs\/search.html\x22},\x22crocks\x22:{\x22children\x22:{\x22Arrow\x22:{\x22title\x22:\x22Arrow\x22,\x22description\x22:\x22Arrow Crock\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:10,\x22srcFilePath\x22:\x22src\/pages\/docs\/crocks\/Arrow.md\x22,\x22id\x22:\x22Arrow\x22,\x22location\x22:\x22\/docs\/crocks\/Arrow.html\x22,\x22url\x22:\x22\/crocks\/docs\/crocks\/Arrow.html\x22},\x22Equiv\x22:{\x22title\x22:\x22Equiv\x22,\x22description\x22:\x22Equiv Crock\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:50,\x22srcFilePath\x22:\x22src\/pages\/docs\/crocks\/Equiv.md\x22,\x22id\x22:\x22Equiv\x22,\x22location\x22:\x22\/docs\/crocks\/Equiv.html\x22,\x22url\x22:\x22\/crocks\/docs\/crocks\/Equiv.html\x22},\x22Pred\x22:{\x22title\x22:\x22Pred\x22,\x22description\x22:\x22Pred Crock\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:100,\x22srcFilePath\x22:\x22src\/pages\/docs\/crocks\/Pred.md\x22,\x22id\x22:\x22Pred\x22,\x22location\x22:\x22\/docs\/crocks\/Pred.html\x22,\x22url\x22:\x22\/crocks\/docs\/crocks\/Pred.html\x22},\x22Reader\x22:{\x22title\x22:\x22Reader\x22,\x22description\x22:\x22Reader Crock\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:110,\x22srcFilePath\x22:\x22src\/pages\/docs\/crocks\/Reader.md\x22,\x22id\x22:\x22Reader\x22,\x22location\x22:\x22\/docs\/crocks\/Reader.html\x22,\x22url\x22:\x22\/crocks\/docs\/crocks\/Reader.html\x22},\x22ReaderT\x22:{\x22title\x22:\x22ReaderT\x22,\x22description\x22:\x22Reader Monad Transformer Crock\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:120,\x22srcFilePath\x22:\x22src\/pages\/docs\/crocks\/ReaderT.md\x22,\x22id\x22:\x22ReaderT\x22,\x22location\x22:\x22\/docs\/crocks\/ReaderT.html\x22,\x22url\x22:\x22\/crocks\/docs\/crocks\/ReaderT.html\x22},\x22State\x22:{\x22title\x22:\x22State\x22,\x22description\x22:\x22State Crock\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:140,\x22srcFilePath\x22:\x22src\/pages\/docs\/crocks\/State.md\x22,\x22id\x22:\x22State\x22,\x22location\x22:\x22\/docs\/crocks\/State.html\x22,\x22url\x22:\x22\/crocks\/docs\/crocks\/State.html\x22,\x22active\x22:true}},\x22title\x22:\x22Crocks\x22,\x22description\x22:\x22Crocks API\x22,\x22layout\x22:\x22notopic\x22,\x22icon\x22:\x22code-file\x22,\x22weight\x22:2,\x22srcFilePath\x22:\x22src\/pages\/docs\/crocks\/index.md\x22,\x22id\x22:\x22crocks\x22,\x22location\x22:\x22\/docs\/crocks\/\x22,\x22url\x22:\x22\/crocks\/docs\/crocks\/\x22,\x22childIds\x22:[\x22Arrow\x22,\x22Equiv\x22,\x22Pred\x22,\x22Reader\x22,\x22ReaderT\x22,\x22State\x22],\x22active\x22:true},\x22functions\x22:{\x22children\x22:{\x22combinators\x22:{\x22description\x22:\x22Combinators API\x22,\x22layout\x22:\x22notopic\x22,\x22title\x22:\x22Combinators\x22,\x22weight\x22:1,\x22srcFilePath\x22:\x22src\/pages\/docs\/functions\/combinators.md\x22,\x22id\x22:\x22combinators\x22,\x22location\x22:\x22\/docs\/functions\/combinators.html\x22,\x22url\x22:\x22\/crocks\/docs\/functions\/combinators.html\x22},\x22helpers\x22:{\x22title\x22:\x22Helpers\x22,\x22description\x22:\x22Helper functions\x22,\x22layout\x22:\x22notopic\x22,\x22weight\x22:2,\x22srcFilePath\x22:\x22src\/pages\/docs\/functions\/helpers.md\x22,\x22id\x22:\x22helpers\x22,\x22location\x22:\x22\/docs\/functions\/helpers.html\x22,\x22url\x22:\x22\/crocks\/docs\/functions\/helpers.html\x22},\x22logic-functions\x22:{\x22description\x22:\x22Logic Functions API\x22,\x22layout\x22:\x22notopic\x22,\x22title\x22:\x22Logic Functions\x22,\x22weight\x22:3,\x22srcFilePath\x22:\x22src\/pages\/docs\/functions\/logic-functions.md\x22,\x22id\x22:\x22logic-functions\x22,\x22location\x22:\x22\/docs\/functions\/logic-functions.html\x22,\x22url\x22:\x22\/crocks\/docs\/functions\/logic-functions.html\x22},\x22pointfree-functions\x22:{\x22title\x22:\x22Point-free Functions\x22,\x22description\x22:\x22Point-free Functions API\x22,\x22layout\x22:\x22notopic\x22,\x22weight\x22:5,\x22srcFilePath\x22:\x22src\/pages\/docs\/functions\/pointfree-functions.md\x22,\x22id\x22:\x22pointfree-functions\x22,\x22location\x22:\x22\/docs\/functions\/pointfree-functions.html\x22,\x22url\x22:\x22\/crocks\/docs\/functions\/pointfree-functions.html\x22},\x22predicate-functions\x22:{\x22description\x22:\x22Predicate Functions API\x22,\x22layout\x22:\x22notopic\x22,\x22title\x22:\x22Predicate Functions\x22,\x22weight\x22:4,\x22srcFilePath\x22:\x22src\/pages\/docs\/functions\/predicate-functions.md\x22,\x22id\x22:\x22predicate-functions\x22,\x22location\x22:\x22\/docs\/functions\/predicate-functions.html\x22,\x22url\x22:\x22\/crocks\/docs\/functions\/predicate-functions.html\x22},\x22transformation-functions\x22:{\x22title\x22:\x22Transformation Functions\x22,\x22description\x22:\x22Transformation Functions API\x22,\x22layout\x22:\x22notopic\x22,\x22weight\x22:6,\x22srcFilePath\x22:\x22src\/pages\/docs\/functions\/transformation-functions.md\x22,\x22id\x22:\x22transformation-functions\x22,\x22location\x22:\x22\/docs\/functions\/transformation-functions.html\x22,\x22url\x22:\x22\/crocks\/docs\/functions\/transformation-functions.html\x22}},\x22title\x22:\x22Functions\x22,\x22description\x22:\x22functions\x22,\x22layout\x22:\x22notopic\x22,\x22icon\x22:\x22code-file\x22,\x22weight\x22:4,\x22srcFilePath\x22:\x22src\/pages\/docs\/functions\/index.md\x22,\x22id\x22:\x22functions\x22,\x22location\x22:\x22\/docs\/functions\/\x22,\x22url\x22:\x22\/crocks\/docs\/functions\/\x22,\x22childIds\x22:[\x22combinators\x22,\x22helpers\x22,\x22logic-functions\x22,\x22predicate-functions\x22,\x22pointfree-functions\x22,\x22transformation-functions\x22]},\x22monoids\x22:{\x22children\x22:{\x22All\x22:{\x22title\x22:\x22All\x22,\x22description\x22:\x22All Monoid\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:10,\x22srcFilePath\x22:\x22src\/pages\/docs\/monoids\/All.md\x22,\x22id\x22:\x22All\x22,\x22location\x22:\x22\/docs\/monoids\/All.html\x22,\x22url\x22:\x22\/crocks\/docs\/monoids\/All.html\x22},\x22Any\x22:{\x22title\x22:\x22Any\x22,\x22description\x22:\x22Any Monoid\x22,\x22layout\x22:\x22guide\x22,\x22weight\x22:20,\x22srcFilePath\x22:\x22src\/pages\/docs\/monoids\/Any.md\x22,\x22id\x22:\x22Any\x22,\x22location\x22:\x22\/docs\/monoids\/Any.html\x22,\x22url\x22:\x22\/crocks\/docs\/monoids\/Any.html\x22}},\x22title\x22:\x22Monoids\x22,\x22description\x22:\x22Monoids API\x22,\x22layout\x22:\x22notopic\x22,\x22icon\x22:\x22code-file\x22,\x22weight\x22:3,\x22srcFilePath\x22:\x22src\/pages\/docs\/monoids\/index.md\x22,\x22id\x22:\x22monoids\x22,\x22location\x22:\x22\/docs\/monoids\/\x22,\x22url\x22:\x22\/crocks\/docs\/monoids\/\x22,\x22childIds\x22:[\x22All\x22,\x22Any\x22]}},\x22title\x22:\x22Documentation\x22,\x22description\x22:\x22Everything you need to know to get started.\x22,\x22srcFilePath\x22:\x22src\/pages\/docs\/index.soy\x22,\x22id\x22:\x22docs\x22,\x22location\x22:\x22\/docs\/\x22,\x22url\x22:\x22\/crocks\/docs\/\x22,\x22childIds\x22:[\x22getting-started\x22,\x22crocks\x22,\x22monoids\x22,\x22functions\x22,\x22search\x22],\x22active\x22:true}},\x22childIds\x22:[\x22docs\x22]},\x22basePath\x22:\x22\/crocks\x22,\x22topbar\x22:[{\x22href\x22:\x22\/crocks\/docs\/\x22,\x22label\x22:\x22Documentation\x22,\x22selected\x22:true}]}}'); if (window.electricPageComponent) {window.electricPageComponent.dispose();}var getByPath = function(obj, path) {path = path.split('.'); for (var i = 0; i < path.length; i++) {obj = obj[path[i]];}; return obj;}; if (window.pageComponent) {var page = getByPath(data.site, data.pageLocation); if (page) {window.electricPageComponent = pageComponent.default.render(pageComponent.default, {element: '#pageComponent > *', page: page, site: data.site});}if (window.runCodeMirror) {runCodeMirror();}}</script><!-- endinject --></div><!-- inject:vendor:js --><script>CodeMirror.defaults.lineNumbers = true; CodeMirror.defaults.matchBrackets = true; CodeMirror.defaults.readOnly = true; CodeMirror.defaults.tabindex = -1; CodeMirror.defaults.tabSize = 2; CodeMirror.defaults.theme = 'blackboard'; CodeMirror.defaults.viewportMargin = Infinity; var REGEX_LB = /&#123;/g; var REGEX_RB = /&#125;/g; function runCodeMirror() {var code = document.querySelectorAll('.code'); for (var i = 0; i < code.length; i++) {var text = code[i].innerText .replace(REGEX_LB, '{') .replace(REGEX_RB, '}'); var editor = CodeMirror(function(elt) {var preEl = code[i].parentNode; preEl.parentNode.appendChild(elt);}, {mode: code[i].getAttribute('data-mode') || '', value: text});}if (window.ElectricCodeTabs) {new window.ElectricCodeTabs();}}runCodeMirror(); function runGoogleAnalytics(path) {if (typeof ga === 'function') {ga('set', 'page', path); ga('send', 'pageview');}}document.addEventListener('DOMContentLoaded', function() {if (typeof senna !== 'undefined') {var app = senna.dataAttributeHandler.getApp(); app.on('endNavigate', function(event) {runGoogleAnalytics(event.path);});}}); (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-37033501-5', 'auto'); ga('send', 'pageview');</script><!-- endinject --></body></html>